<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Generate Prompt - PromptCart</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon" />


  <script>
    // Theme
    if (localStorage.getItem("theme") === "light") {
      document.documentElement.classList.add("light-theme");
    }

    // Auth check
    if (localStorage.getItem("isLoggedIn") !== "true") {
      window.location.href = "login.html";
    }
  </script>

  <!-- ‚ö†Ô∏è STYLES UNCHANGED -->
  <style>
:root { --primary: #6C63FF; --primary-hover: #5850e6; --bg: #0f0f23; --bg-card: #1a1a2e; --bg-hover: #252540; --text: #e4e4e7; --text-muted: #a1a1aa; --border: #27272a; --success: #10b981; } :root.light-theme { --bg: #f4f4f5; --bg-card: #ffffff; --bg-hover: #f9fafb; --text: #18181b; --text-muted: #71717a; --border: #e4e4e7; } * { margin: 0; padding: 0; box-sizing: border-box; } body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif; background: var(--bg); color: var(--text); overflow-x: hidden; } .navbar { background: var(--bg-card); border-bottom: 1px solid var(--border); padding: 16px 24px; display: flex; align-items: center; justify-content: space-between; position: sticky; top: 0; z-index: 100; } .logo { font-size: 20px; font-weight: 700; background: linear-gradient(135deg, var(--primary) 0%, #a78bfa 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; } .light-theme .logo { background: linear-gradient(135deg, var(--primary) 0%, #8b5cf6 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; } .user-avatar { width: 36px; height: 36px; border-radius: 50%; background: linear-gradient(135deg, var(--primary) 0%, #a78bfa 100%); display: flex; align-items: center; justify-content: center; font-weight: 600; cursor: pointer; transition: transform 0.3s ease; } .user-avatar:hover { transform: scale(1.05); } .container { display: flex; min-height: calc(100vh - 69px); } .sidebar { width: 260px; background: var(--bg-card); border-right: 1px solid var(--border); padding: 24px 0; position: sticky; top: 69px; height: calc(100vh - 69px); overflow-y: auto; } .sidebar-item { padding: 12px 24px; display: flex; align-items: center; gap: 12px; color: var(--text-muted); text-decoration: none; transition: all 0.3s ease; cursor: pointer; font-size: 14px; } .sidebar-item:hover { background: var(--bg-hover); color: var(--text); } .sidebar-item.active { background: rgba(108, 99, 255, 0.1); color: var(--primary); border-left: 3px solid var(--primary); } .sidebar-item span { font-size: 18px; } .main-content { flex: 1; padding: 32px; overflow-y: auto; } .page-title { font-size: 28px; font-weight: 600; margin-bottom: 24px; } .generator-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; padding: 32px; max-width: 800px; margin-bottom: 32px; } .form-group { margin-bottom: 24px; } .form-label { display: block; margin-bottom: 8px; font-weight: 500; color: var(--text); } .form-input, .form-select, .form-textarea { width: 100%; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; padding: 12px 16px; color: var(--text); font-family: inherit; transition: border-color 0.3s ease; } .form-textarea { min-height: 120px; resize: vertical; } .form-input:focus, .form-select:focus, .form-textarea:focus { outline: none; border-color: var(--primary); } .btn-generate { background: var(--primary); color: white; border: none; padding: 14px 32px; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; gap: 8px; } .btn-generate:hover { background: var(--primary-hover); transform: translateY(-2px); } .result-section { background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; padding: 32px; max-width: 800px; display: none; animation: fadeIn 0.5s ease; } @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } } .result-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; } .result-title { font-size: 18px; font-weight: 600; } .prompt-output { background: var(--bg); padding: 20px; border-radius: 8px; border: 1px solid var(--border); color: var(--text-muted); line-height: 1.6; white-space: pre-wrap; } .mobile-menu-btn { display: none; background: none; border: none; color: var(--text); font-size: 24px; cursor: pointer; } @media (max-width: 768px) { .sidebar { position: fixed; left: -260px; top: 69px; z-index: 99; transition: left 0.3s ease; } .sidebar.open { left: 0; } .mobile-menu-btn { display: block; } .main-content { padding: 20px; } }
  </style>
</head>

<body>

<nav class="navbar">
  <div style="display:flex;align-items:center;gap:16px;">
    <button class="mobile-menu-btn" id="menuToggle">‚ò∞</button>
    <img src="logo.png" style="height:32px">
    <div class="logo">PromptCart</div>
  </div>
  <div class="user-avatar" onclick="location.href='settings.html'">U</div>
</nav>

<div class="container">
  <aside class="sidebar" id="sidebar">
    <a href="index.html" class="sidebar-item">üìä Dashboard</a>
    <a href="templates.html" class="sidebar-item">üìù Templates</a>
    <a href="liked.html" class="sidebar-item">‚ù§Ô∏è Liked</a>

    <!-- ‚úÖ FIXED ROUTE -->
    <a href="generate.html" class="sidebar-item active">‚ú® Generate</a>

    <a href="settings.html" class="sidebar-item">‚öôÔ∏è Settings</a>
  </aside>

  <main class="main-content">
    <h1 class="page-title">Generate New Prompt</h1>

    <div class="generator-card">

      <input id="userRole" class="form-input" placeholder="Role" />
      <input id="userDomain" class="form-input" placeholder="Domain" />

      <textarea id="userObjective" class="form-textarea"
        placeholder="What do you want to reshape?"></textarea>

      <input id="userAudience" class="form-input" placeholder="Audience" />

      <select id="userTone" class="form-select">
        <option>Professional</option>
        <option>Casual</option>
        <option>Persuasive</option>
        <option>Educational</option>
      </select>

      <input id="userConstraints" class="form-input"
        placeholder="Constraints (optional)" />

      <button id="generateBtn" class="btn-generate">‚ú® Generate Magic</button>
    </div>

    <div class="result-section" id="resultSection">
      <div class="result-header">
        <h3>Generated Prompt</h3>
        <button id="copyBtn">üìã Copy</button>
      </div>
      <div id="promptOutput" class="prompt-output"></div>
    </div>
  </main>
</div>

<!-- ‚úÖ SCRIPT (FIXED & STABLE) -->
<script>
const generateBtn = document.getElementById("generateBtn");
const resultSection = document.getElementById("resultSection");
const promptOutput = document.getElementById("promptOutput");
const copyBtn = document.getElementById("copyBtn");

// Inputs
const userRole = document.getElementById("userRole");
const userDomain = document.getElementById("userDomain");
const userObjective = document.getElementById("userObjective");
const userAudience = document.getElementById("userAudience");
const userTone = document.getElementById("userTone");
const userConstraints = document.getElementById("userConstraints");

generateBtn.addEventListener("click", async () => {
  if (!userObjective.value.trim()) {
    alert("Please enter what you want to generate.");
    return;
  }

  generateBtn.disabled = true;
  generateBtn.textContent = "‚è≥ Generating...";

  const payload = {
    role: userRole.value.trim(),
    domain: userDomain.value.trim(),
    objective: userObjective.value.trim(),
    targetAudience: userAudience.value.trim(), // ‚úÖ FIXED
    tone: userTone.value,
    constraints: userConstraints.value.trim()
  };

  try {
    const res = await fetch("/api/generate", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(payload)
    });

    if (!res.ok) {
      throw new Error("API not responding");
    }

    const data = await res.json();
    promptOutput.textContent = data.prompt;
    resultSection.style.display = "block";

  } catch (err) {
    console.error(err);
    alert("‚ùå Failed to generate prompt. API not responding.");
  } finally {
    generateBtn.disabled = false;
    generateBtn.textContent = "‚ú® Generate Magic";
  }
});

copyBtn.addEventListener("click", () => {
  navigator.clipboard.writeText(promptOutput.textContent);
  copyBtn.textContent = "‚úÖ Copied";
  setTimeout(() => {
    copyBtn.textContent = "üìã Copy";
  }, 1500);
});
</script>



</body>
</html>
